---
import Spacer from '@components/core/spacer.astro';
import Text from '@components/text/text.astro';
import { Picture } from 'astro:assets';
import ProjectTitle from '@components/project/project-title.astro';
import ProjectTeam from '@components/project/project-team.astro';
import ProjectLink from '@components/project/project-link.astro';
import ProjectTools from '@components/project/project-tools.astro';
import ProjectLanguages from '@components/project/project-languages.astro';
import ProjectContributions from '@components/project/project-contributions.astro';
import ProjectDateTags from '@components/project/project-date-tags.astro';
import HorizontalRow from '@layouts/structure/horizontal-row.astro';
import MediaElements from '@components/core/image/media-elements.astro';
import TextPair from '@components/text/text-pair.astro';
import ProjectPlatforms from '@components/project/project-platforms.astro';
import ProjectLinks from '@components/project/routing/ProjectLinks.astro';
import MediaElement from '@components/media/MediaElement.astro';
import MediaGallery from '@components/media/MediaGallery.astro';
import DateTimeBlock from '@components/text/dateTimeBlock.astro';
import TextInlineList from '@components/text/TextInlineList.astro';
import ProjectDescription from '@components/project/ProjectDescription.astro';
interface Props {
	project: Project;
}

const { project } = {
	project: Astro.props.project
};

const projectLink = project.getProjectLink();
const hasPlatforms = project.data.platforms && project.data.platforms.length > 0;
const hasPage = projectLink != null;
const hasLinks = hasPlatforms || projectLink != null;

const videos = project.Media.Videos;
const images = project.Media.Images;
---

<article
	class=`relative inline-flex ${project.isProfessional() ? "min-h-175" : "min-h-145"} w-full max-w-full overflow-hidden rounded-lg break-words md:rounded-[10px] group/project`>
	<div class="pointer-events-none absolute -z-1 h-full w-full bg-black"></div>

	<Picture
		class=`pointer-events-none absolute -z-1 h-full w-full object-cover opacity-25 group-hover/project:opacity-30 scale-101 group-hover/project:scale-100 transition-discrete
transition-all duration-500 ease-out`
		src={project.getCover()}
		alt=""
		aria-hidden="true"
	/>
<!--	{!project.isExternal() &&
		&lt;!&ndash;Padded bc its kind of easy to just click the project by mistake&ndash;&gt;
		<div class="absolute w-full h-full flex p-6">
			<a
				class='flex grow'
				href={project.getProjectLink()}
				target={'_self'}
				rel="noreferrer"/>
		</div>
	}-->
	<div class=`image-background pointer-events-none absolute -z-1 h-full w-full`></div>
	<div class=`content-outer`>
		<div class=`content-inner-l gap-2`>
			<p class="text-tag !mt-0">
				<DateTimeBlock start={project.data.dateStart} end={project.data.dateEnd} />
			</p>
			<ProjectTitle project={project} />

			<Spacer />
			<MediaGallery class=`flex-col sm:flex-row gap-4 sm:max-w-[38ch]! sm:mr-12`>
				<div class="flex flex-col gap-4 grow h-full">
					{videos.map((video, index) => (index > 0 ? <MediaElement class=`hidden` Source={video}/> : <MediaElement class=`flex flex-col aspect-video grow h-full` Source={video} />))}
				</div>
				<div class="flex flex-row sm:flex-col gap-4 shrink">
					{images.map((image, index) => (index > 1 ? <MediaElement class=`hidden` Source={image}/> : <MediaElement class=`aspect-video h-full` Source={image} width={640} height={360} />))}
				</div>
			</MediaGallery>
			<ProjectDescription project={project} />
			<TextInlineList contents={project.data.tags} class="self-start !mt-2" />
		</div>
		<div class=`gap-4 flex-col content-inner-r`>
			<div class=`flex flex-col grow content-inner-padding`>
				<div class=`grid grid-cols-2 gap-x-4 gap-y-2 pb-4`>
					<ProjectTeam project={project} class="md:mt-0" />
					<TextPair heading="Tools" type="custom"><ProjectTools project={project} /></TextPair>
					<TextPair heading="Languages" type="custom"><ProjectLanguages project={project} /></TextPair>
				</div>
				<!--<Spacer horizontalLine class="max-w-[25%]"/>-->
				<TextPair heading="Key Contributions" type="custom">
					<ProjectContributions project={project} />
				</TextPair>
			</div>

			<Spacer />
			<ProjectLinks project={project} class="justify-end-safe flex" />
		</div>

	</div>
</article>

<!--<div class="bg-black pointer-events-none absolute -z-1 h-full w-full opacity-15"/>-->
<!--<div class="relative shrink rounded-lg md:rounded-2xl">
	<div
		class="card-spacing relative sticky inline-flex min-h-82 shrink flex-col md:flex
			md:flex-row md:flex-wrap">
		<ImageBlock
			project={project}
			class={'flex flex-1 md:max-h-[40vh] md:max-w-130 xl:min-w-auto shrink-2 grow-[0.5]'}
		/>
		<div class="flex flex-2 grow flex-col md:min-w-full xl:min-w-124">
			<DateTimeBlock
				start={project.data.dateStart}
				end={project.data.dateEnd}
			/>
			<Spacer />
			<Text type="heading" class="mb-2">{project.data.title}</Text>
			<Text type="paragraph" class="line-clamp-6"
				>{project.data.description}</Text
			>

			<ProjectInfo project={project} class="mb-8 flex gap-8 md:hidden" />

			<div class="mb-3 flex flex-row gap-x-2">
				<Tag>Tech Designer</Tag>
				<Tag>Professional</Tag>
			</div>
			<div class="border-fade-primary-white flex flex-row border-t pt-3">
				<Button text="Learn More" link="https://www.google.com/" />
			</div>
		</div>
	</div>
</div>-->

<!--Alt-->
<!--
<div class="hidden gap-4 md:flex md:w-3/8 md:flex-col">
	<HorizontalRow class="shrink overflow-clip mb-2">
		<ProjectTeam project={project} />
		<Spacer verticalLine />
		<ProjectLanguages project={project} />
		<Spacer verticalLine />
		<ProjectTools project={project} />
	</HorizontalRow>
	<ProjectContributions project={project} />
	<Spacer />
	<div class="grid grid-cols-3 gap-4 max-h-[170px]">
		<MediaElement class="col-span-2 row-span-2" image={project.data.images[0]} alt="Cover" />
		<MediaElement class="col-span-1" image={project.data.images[0]} alt="Cover" />
		<MediaElement class="col-span-1" image={project.data.images[0]} alt="Cover" />
	</div>
</div>-->

<!--<HorizontalRow>-->
<!--	<Spacer />-->
<!--	<ProjectTools project={project} />-->
<!--</HorizontalRow>-->
