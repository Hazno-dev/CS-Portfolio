---
import Spacer from '@components/core/spacer.astro';
import Text from '@components/text/text.astro';
import { Picture } from 'astro:assets';
import ProjectTitle from '@components/project/project-title.astro';
import ProjectTeam from '@components/project/project-team.astro';
import ProjectTools from '@components/project/project-tools.astro';
import ProjectLanguages from '@components/project/project-languages.astro';
import ProjectContributions from '@components/project/project-contributions.astro';
import ProjectDateTags from '@components/project/project-date-tags.astro';
import MediaElements from '@components/core/image/media-elements.astro';
import TextPair from '@components/text/text-pair.astro';
import ProjectLinks from '@components/project/routing/ProjectLinks.astro';
import MediaElement from '@components/media/MediaElement.astro';
import MediaGallery from '@components/media/MediaGallery.astro';
interface Props {
	project: Project;
}

const { project } = {
	project: Astro.props.project
};

const projectLink = project.getProjectLink();
const hasPlatforms = project.data.platforms && project.data.platforms.length > 0;

const videos = project.Media.Videos;
const images = project.Media.Images;
---

<article
	class=`relative inline-flex ${project.isProfessional() ? "min-h-175" : "min-h-145"} w-full max-w-full overflow-hidden rounded-lg break-words md:rounded-[10px] group/project`>
	<div class="pointer-events-none absolute -z-1 h-full w-full bg-black"></div>
	<Picture
		class=`pointer-events-none absolute -z-1 h-full w-full object-cover opacity-25 group-hover/project:opacity-30 scale-101 group-hover/project:scale-100 transition-all duration-500 ease-out`
		src={project.getCover()}
		alt=""
		aria-hidden="true"
	/>
	<div class=`image-background pointer-events-none absolute -z-1 h-full w-full`></div>
	<div class=`content-outer`>
		<div class=`content-inner-l`>
			<ProjectTitle project={project} />
			<Spacer />
			<ProjectDateTags project={project} class="mt-4" />
			<Text type="paragraph" class=`!md:mb-0 line-clamp-5 !max-w-[47ch]`>{project.data.description}</Text>
			<MediaGallery class=`md:hidden flex-col gap-4 sm:flex-row`>
				{videos.map((video, index) => (index > 0 ? <MediaElement class=`hidden` Source={video}/> : <MediaElement Source={video} />))}
				<div class="flex flex-row gap-4 sm:flex-col">
					{images.map((image, index) => (index > 1 ? <MediaElement class=`hidden` Source={image}/> : <MediaElement Source={image} />))}
				</div>
			</MediaGallery>
			<ProjectLinks project={project} class="hidden md:flex" />
		</div>
		<div class=`gap-4 flex-col content-inner-r`>
			<div class=`flex flex-col grow content-inner-padding`>
				<div class=`grid grid-cols-2 gap-x-4 gap-y-2 pb-4`>
					<ProjectTeam project={project} />
					<TextPair heading="Tools" type="custom"><ProjectTools project={project} /></TextPair>
					<TextPair heading="Languages" type="custom"><ProjectLanguages project={project} /></TextPair>
				</div>
				<TextPair heading="Key Contributions" type="custom">
					<ProjectContributions project={project} />
				</TextPair>
			</div>

			<Spacer />

			<MediaElements
				project={project}
				class=`hidden md:flex h-[160px] flex-row gap-4 transition-[opacity] duration-200 ease-out group-hover/project:opacity-100
					md:max-w-[600px] md:opacity-80`
			/>
		</div>

		<ProjectLinks project={project} class="justify-end-safe flex md:hidden" />
	</div>
</article>